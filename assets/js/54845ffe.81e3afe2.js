"use strict";(self.webpackChunkkai_dev=self.webpackChunkkai_dev||[]).push([[4467],{3905:(t,e,n)=>{n.d(e,{Zo:()=>l,kt:()=>m});var a=n(7294);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function d(t,e){if(null==t)return{};var n,a,r=function(t,e){if(null==t)return{};var n,a,r={},o=Object.keys(t);for(a=0;a<o.length;a++)n=o[a],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var s=a.createContext({}),c=function(t){var e=a.useContext(s),n=e;return t&&(n="function"==typeof t?t(e):i(i({},e),t)),n},l=function(t){var e=c(t.components);return a.createElement(s.Provider,{value:e},t.children)},p="mdxType",u={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},v=a.forwardRef((function(t,e){var n=t.components,r=t.mdxType,o=t.originalType,s=t.parentName,l=d(t,["components","mdxType","originalType","parentName"]),p=c(n),v=r,m=p["".concat(s,".").concat(v)]||p[v]||u[v]||o;return n?a.createElement(m,i(i({ref:e},l),{},{components:n})):a.createElement(m,i({ref:e},l))}));function m(t,e){var n=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var o=n.length,i=new Array(o);i[0]=v;var d={};for(var s in e)hasOwnProperty.call(e,s)&&(d[s]=e[s]);d.originalType=t,d[p]="string"==typeof t?t:r,i[1]=d;for(var c=2;c<o;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}v.displayName="MDXCreateElement"},4419:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>s,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>d,toc:()=>c});var a=n(7462),r=(n(7294),n(3905));const o={sidebar_position:3,description:""},i="Provider Pattern",d={unversionedId:"DesignPatterns/ProviderPattern",id:"DesignPatterns/ProviderPattern",title:"Provider Pattern",description:"",source:"@site/docs/DesignPatterns/ProviderPattern.md",sourceDirName:"DesignPatterns",slug:"/DesignPatterns/ProviderPattern",permalink:"/docs/DesignPatterns/ProviderPattern",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,description:""},sidebar:"tutorialSidebar",previous:{title:"Singleton Pattern",permalink:"/docs/DesignPatterns/SingletonPattern"},next:{title:"Leet code",permalink:"/docs/category/leet-code"}},s={},c=[{value:"\u524d\u8a00",id:"\u524d\u8a00",level:2},{value:"\u7bc4\u4f8b",id:"\u7bc4\u4f8b",level:2},{value:"\u5be6\u52d9\u61c9\u7528",id:"\u5be6\u52d9\u61c9\u7528",level:2},{value:"\u512a\u7f3a\u9ede",id:"\u512a\u7f3a\u9ede",level:2}],l={toc:c},p="wrapper";function u(t){let{components:e,...n}=t;return(0,r.kt)(p,(0,a.Z)({},l,n,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"provider-pattern"},"Provider Pattern"),(0,r.kt)("p",null,"\u53c3\u8003\u9023\u7d50\uff1a ",(0,r.kt)("a",{parentName:"p",href:"https://pjchender.dev/react/react-context-provider-api/"},"React Context, Provider and useContext")),(0,r.kt)("p",null,"\u6b64\u7bc7\u539f\u6587\uff1a",(0,r.kt)("a",{parentName:"p",href:"https://www.patterns.dev/posts/provider-pattern"},"Provider Pattern"),"\uff0c\u8a73\u7d30\u7684\u4ecb\u7d39\u53ef\u4ee5\u8b80\u9019\u7bc7\u6587\u7ae0\uff0c\u6703\u6709\u4e00\u500b\u6b65\u9a5f\u4e00\u6b65\u9a5f\u7684\u904e\u7a0b\uff0c\u4e26\u4e14\u642d\u914d\u5716\u7247\u505a\u8aaa\u660e"),(0,r.kt)("h2",{id:"\u524d\u8a00"},"\u524d\u8a00"),(0,r.kt)("p",null,"\u7576 Component \u592a\u591a\u592a\u6df1\u5c64\uff0c\u9700\u8981\u50b3\u905e\u53c3\u6578\u6642\uff0c\u53ef\u80fd\u6703\u5f9e Root \u7d50\u9ede\u4e00\u8def\u50b3\u905e\u4e0b\u53bb\uff0c\u9020\u6210 code \u4e0d\u597d\u95b1\u8b80\uff0cProvider Pattern \u53ef\u4ee5\u900f\u904e Provider \u8207 useContext hook \uff0c\u8b93\u8cc7\u6599\u5b58\u5728\u5916\u5c64\u7684 Provider \uff0c\u8981\u4f7f\u7528\u7684 component \u53ef\u4ee5\u4f7f\u7528 hook \u4f86\u53d6\u5f97\u9700\u8981\u7684\u8cc7\u6599"),(0,r.kt)("h2",{id:"\u7bc4\u4f8b"},"\u7bc4\u4f8b"),(0,r.kt)("p",null,"\u5728\u6c92\u6709\u4f7f\u7528 Provider Pattern \u6642\uff0cprops data \u8981\u50b3\u905e\u5230\u5e95\u5c64\u7684 component \uff0c\u53ea\u80fd\u4e00\u5c64\u4e00\u5c64\u50b3\uff0c\u4e26\u4e14\u9084\u6709\u4e2d\u9593\u5c64\u662f\u53ea\u70ba\u4e86\u50b3\u905e props \u5c31\u9700\u8981\u5f15\u7528\u4e26\u4e14 assign"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="Before Provider Pattern"',title:'"Before',Provider:!0,'Pattern"':!0},"function App() {\n  const data = { ... }\n\n  return (\n    <div>\n      <SideBar data={data} />\n      <Content data={data} />\n    </div>\n  )\n}\n\nconst SideBar = ({ data }) => <List data={data} />\nconst List = ({ data }) => <ListItem data={data} />\nconst ListItem = ({ data }) => <span>{data.listItem}</span>\n\nconst Content = ({ data }) => (\n  <div>\n    <Header data={data} />\n    <Block data={data} />\n  </div>\n)\nconst Header = ({ data }) => <div>{data.title}</div>\nconst Block = ({ data }) => <Text data={data} />\nconst Text = ({ data }) => <h1>{data.text}</h1>\n")),(0,r.kt)("p",null,"\u4f7f\u7528\u65b9\u5f0f\u5f88\u7c21\u55ae"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u4f7f\u7528 createContext \u5efa\u7acb\u4e00\u500b Provider\uff0c\u4e26\u4e14\u5305\u5728\u6700\u5916\u5c64 Component \u5916\u9762"),(0,r.kt)("li",{parentName:"ol"},"\u4f7f\u7528 useContext \u53d6\u5f97 Provider \u7684\u5132\u5b58\u7684\u8cc7\u6599")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="Create Provider"',title:'"Create','Provider"':!0},"const DataContext = React.createContext()\n\nfunction App() {\n  const data = { ... }\n\n  return (\n    <div>\n      <DataContext.Provider value={data}>\n        <SideBar />\n        <Content />\n      </DataContext.Provider>\n    </div>\n  )\n}\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="Use Provider Data"',title:'"Use',Provider:!0,'Data"':!0},"const SideBar = () => <List />;\nconst List = () => <ListItem />;\nconst Content = () => (\n  <div>\n    <Header />\n    <Block />\n  </div>\n);\n\nfunction ListItem() {\n  const {data} = React.useContext(DataContext);\n  return <span>{data.listItem}</span>;\n}\n\nfunction Text() {\n  const {data} = React.useContext(DataContext);\n  return <h1>{data.text}</h1>;\n}\n\nfunction Header() {\n  const {data} = React.useContext(DataContext);\n  return <div>{data.title}</div>;\n}\n")),(0,r.kt)("p",null,"\u800c\u5728\u6211\u5728\u5be6\u52d9\u4e0a\uff0c\u6703\u5c07 Provider \u8207 Hook \u5305\u6210\u4e00\u500b\u6a94\u6848\uff0c\u65b9\u4fbf\u4f7f\u7528"),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"\u8a73\u7d30\u53ef\u4ee5\u53c3\u8003\u4e0a\u9762\u9023\u7d50\u7684\u6587\u7ae0\uff0c\u6703\u5c0d Provider \u7684\u4f7f\u7528\u66f4\u6709\u60f3\u6cd5\u8207\u756b\u9762")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="Provider file"',title:'"Provider','file"':!0},"import React, { createContext, useCallback, useContext, useMemo, useState } from 'react';\n\nconst DataContext = createContext(undefined);\n\nexport function DataProvider({ value, children }) {\n  const [data, setData] = useState(value);\n\n  const initData = useCallback(() => {\n    setData({...});\n  }, []);\n\n  const contextData = useMemo(() => {\n    return {\n      data,\n      initData,\n    };\n  }, [data, initData]);\n\n  return (\n    <DataContext.Provider value={contextData}>\n      {children}\n    </DataContext.Provider>\n  );\n}\n\nexport function useData() {\n  const contextData = useContext(DataContext);\n\n  if (contextData === undefined) {\n    throw new Error('useData must be used within a DataProvider');\n  }\n\n  return contextData;\n}\n")),(0,r.kt)("p",null,"\u5c31\u53ef\u4ee5\u900f\u904e\u53d6\u51fa Provider \u8207 hook \u4f86\u4f7f\u7528"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"import {DataProvider, useData} from '~/DataProvider'\n\nfunction App() {\n  const data = { ... }\n\n  return (\n    <div>\n      <DataProvider value={data}>\n        <SideBar />\n        <Content />\n      </DataProvider>\n    </div>\n  )\n}\n\nconst SideBar = () => <List />\nconst List = () => <ListItem />\nconst Content = () => <div><Header /><Block /></div>\n\nfunction ListItem() {\n  const { data } = useData();\n  return <span>{data.listItem}</span>;\n}\n\nfunction Text() {\n  const { data } = useData();\n  return <h1>{data.text}</h1>;\n}\n\nfunction Header() {\n  const { data } = useData();\n  return <div>{data.title}</div>;\n}\n")),(0,r.kt)("h2",{id:"\u5be6\u52d9\u61c9\u7528"},"\u5be6\u52d9\u61c9\u7528"),(0,r.kt)("h2",{id:"\u512a\u7f3a\u9ede"},"\u512a\u7f3a\u9ede"))}u.isMDXComponent=!0}}]);